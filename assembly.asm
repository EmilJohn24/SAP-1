MOVA $Multiplicand
STA $Q;
MVI C, 0x08;
LDA $M
MOV B, A

CHECK:
LDA $Q;
ANI 0x01;
JZ Q0_ZERO:

Q0_ONE:
;11
LDA $Q_PRESHIFT;
ANI 0x01;
JNZ INC_COUNT;
;10
SUB B;
JMP INC_COUNT;

Q0_ZERO:
;00
LDA $Q_PRESHIFT;
ANI 0x01;
JZ INC_COUNT;
;01
ADD B;

INC_COUNT:
DEC C;

SHIFT:
LDA $A;
ANI 0x80;
JNZ SIGN_1

SIGN_0:
RRC;
ANI 0x7F;
JMP SHIFT_Q;

SIGN_1:
RRC;
ORI 0x80;

SHIFT_Q:
STA $A_SHIFTED;
LDA $A;
RRC;
JC A0_ONE;


A0_ONE:
LDA $Q;
STA $Q_PRESHIFT;
RRC;
ORI 0x80;
JMP CHECK_COUNT;

A0_ZERO:
LDA $Q;
STA $Q_PRESHIFT;
RRC;
ANI 0x7F;

CHECK_COUNT:
STA $Q;
;RETURN to $A
LDA $A_SHIFTED;
STA $A;
MOV A,C;
ANI 0xFF;
JNZ CHECK;
HLT;
;00001111
;11010101
