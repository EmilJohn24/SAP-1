IN;
STA $F0;
IN;
STA $F1;
LDA $F1;
STA $F2;
MVI 0x08;
LDA $F0;
MOV B,A;

CHECK:
LDA $F2;
ANI 0x01;
JZ Q0_ZERO;

Q0_ONE:
LDA $F4;
ANI 0x01;
JNZ SHIFT;
LDA $F3;
SUB B;
STA $F3;
JMP SHIFT;

Q0_ZERO:
LDA $F4;
ANI 0x01;
JZ SHIFT;
LDA $F3;
ADD B;
STA $F3;

SHIFT:
LDA $F3;
ANI 0x38;
JNZ SIGN_1;

SIGN_0:
LDA $F3;
RRC;
ANI 0x7F;
JMP SHIFT_Q;

SIGN_1:
LDA $F3;
RRC;
ORI 0x80;

SHIFT_Q:
STA $F5;
LDA $F3;
RRC;
JC A0_ONE;

A0_ZERO:
LDA $F2;
STA $F4;
RRC;
ANI 0x7F;
JMP CHECK_COUNT;

A0_ONE:
LDA $F2;
STA $F4;
RRC;
ORI 0x80;

CHECK_COUNT:
STA $F2;
LDA $F5;
STA $F3;
DEC C;
JNZ CHECK;
HLT;
